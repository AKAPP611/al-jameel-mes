<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Pistachio ‚Äì Al Jameel MES</title>
<style>
  /* ============ Brand Tokens (Al Jameel) ============ */
  :root{
    --brand-primary: #a32034;   /* Deep Red */
    --brand-primary-600:#8b1a2a;
    --brand-primary-700:#781624;
    --brand-accent:  #d5a333;   /* Gold */
    --text:          #2f2a28;   /* Dark Charcoal */
    --bg:            #f3f4f6;   /* Light Gray */
    --surface:       #ffffff;
    --muted:         #6b7280;
    --border:        #e5e7eb;

    --success: #16a34a;
    --danger:  #dc3545;
    --warn:    #fff3cd;
    --info:    #eef2ff;
  }

  *{margin:0; padding:0; box-sizing:border-box}
  body{
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    background: var(--bg);
    color: var(--text);
  }

  /* ======= Header / Nav ======= */
  .header{
    background: var(--brand-primary);
    color:#fff;
    padding:20px;
    display:flex; justify-content:space-between; align-items:center;
  }
  .header h1{ font-size:20px; letter-spacing:.2px }
  .header a.back{
    color:#fff; text-decoration:none; background:rgba(255,255,255,.12);
    padding:8px 12px; border-radius:10px; margin-right:10px;
  }

  .container{ max-width:1200px; margin:0 auto; padding:20px }

  .nav-buttons{ display:flex; gap:10px; margin-bottom:20px; flex-wrap:wrap }
  .nav-btn{
    padding:10px 20px; background:var(--brand-primary); color:#fff;
    border:none; border-radius:8px; cursor:pointer; font-size:16px;
    min-height:44px;
  }
  .nav-btn:hover{ background:var(--brand-primary-600) }
  .nav-btn.active{ background:var(--brand-primary-700) }
  .nav-btn.print-btn{
    background: linear-gradient(135deg, var(--brand-accent), #e0b760);
    color:#2f2a28; border:2px solid var(--brand-accent); font-weight:700;
    box-shadow:0 2px 4px rgba(213,163,51,.25);
  }
  .nav-btn.print-btn:hover{
    filter:brightness(.95);
    transform:translateY(-1px);
    box-shadow:0 4px 8px rgba(213,163,51,.35);
  }

  /* ======= Sections / Cards ======= */
  .section{ display:none; background:var(--surface); padding:20px; border-radius:12px; box-shadow:0 2px 4px rgba(0,0,0,.06) }
  .section.active{ display:block }

  .form-grid{ display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:15px; margin-bottom:20px }
  .form-grid.materials-grid{ grid-template-columns:repeat(auto-fit,minmax(180px,1fr)) }

  .form-group{ display:flex; flex-direction:column }
  label{ margin-bottom:6px; font-weight:700; color:#444 }

  input, select{
    padding:10px; border:1px solid var(--border); border-radius:10px;
    font-size:16px; background:#fff;
  }
  select:focus, input:focus{
    outline:none; border-color:var(--brand-accent);
    box-shadow:0 0 0 2px rgba(213,163,51,.25);
  }

  /* Prominent selects (box types) */
  select#boxTypeUsed, select#boxTypeWasted{
    background:#fff7e6; border:2px solid #f5e1a8; font-weight:600;
  }
  select#boxTypeUsed:focus, select#boxTypeWasted:focus{
    background:#fff2cc; border-color:var(--brand-accent);
  }

  button{
    padding:12px 24px; background:var(--brand-primary); color:#fff;
    border:none; border-radius:10px; cursor:pointer; font-size:16px; min-height:44px;
  }
  button:hover{ background:var(--brand-primary-600) }

  .output-section{ background:#fafafa; padding:15px; border-radius:10px; margin:20px 0; border:1px solid var(--border) }
  .reject-section{ background:var(--warn); padding:15px; border-radius:10px; margin:20px 0; border:1px solid #ffe8a6 }
  .wastage-section{ background:#fde2e4; padding:15px; border-radius:10px; margin:20px 0; border:1px solid #f8bfc4 }
  .materials-section{ background:#fff7e6; padding:15px; border-radius:10px; margin:20px 0; border:1px solid #f5e1a8 }

  .table-container{ overflow-x:auto; margin-top:20px; padding-bottom:10px; -webkit-overflow-scrolling:touch }
  table{ width:100%; border-collapse:collapse; min-width:500px }
  th, td{ padding:12px; text-align:left; border-bottom:1px solid var(--border) }
  th{ background:var(--brand-primary); color:#fff }

  .stats-grid{ display:grid; grid-template-columns:repeat(auto-fit,minmax(180px,1fr)); gap:20px; margin-bottom:30px }
  .stat-card{
    background:linear-gradient(0deg, #fff, #fff);
    padding:20px; border-radius:12px; text-align:center;
    border:2px solid var(--brand-accent);
  }
  .stat-value{ font-size:2em; font-weight:800; color:var(--brand-primary) }

  .action-buttons{ display:flex; gap:10px }
  .edit-btn{ background:#ff9800 }
  .delete-btn{ background:#dc3545 }

  .total-box{ background:#fff7e6; padding:10px; margin-top:10px; border-radius:8px; font-weight:700; border:1px solid #f5e1a8 }

  .warning-box{ background:#fff3cd; border:1px solid #ffeeba; color:#7a5d00; padding:15px; border-radius:10px; margin-bottom:20px }

  /* Print theme to brand */
  .print-container{ display:none; position:relative }
  .print-container::before{
    content:"CONFIDENTIAL"; position:fixed; top:50%; left:50%;
    transform:translate(-50%,-50%) rotate(-45deg);
    font-size:80px; color:rgba(163,32,52,.04); font-weight:800; z-index:0; pointer-events:none;
  }
  .print-header{
    text-align:center; background:linear-gradient(135deg, var(--brand-primary) 0%, var(--brand-primary-600) 100%);
    color:#fff; padding:20px 15px; margin:0 0 30px 0; border-radius:0 0 20px 20px; position:relative; z-index:1; width:100%;
  }
  .print-header h1{ color:#fff; font-size:28px; margin:0 0 10px 0; text-shadow:2px 2px 4px rgba(0,0,0,.2) }
  .print-header .subtitle{ color:#ffe9b3; font-size:13px; margin:5px 0 }
  .print-section{ margin-bottom:30px; position:relative; z-index:1 }
  .print-section h2{ color:var(--brand-primary); font-size:20px; margin-bottom:15px; border-bottom:2px solid #e0e0e0; padding-bottom:5px }
  .print-stat-card{ background:linear-gradient(135deg,#f5f5f5 0%, #fff7e6 100%); padding:15px; border-radius:8px; text-align:center; border:1px solid #f5e1a8; box-shadow:0 2px 4px rgba(0,0,0,.06) }
  .print-stat-card h3{ color:var(--brand-primary); font-size:14px; margin-bottom:10px }
  .print-stat-card .value{ font-size:24px; font-weight:800; color:var(--brand-primary-700) }
  .print-table{ width:100%; border-collapse:collapse; font-size:12px }
  .print-table th{ background:var(--brand-primary); color:#fff; padding:8px; text-align:left }
  .print-table td{ padding:6px 8px; border-bottom:1px solid #ddd }

  /* Mobile polish */
  @media (max-width:768px){
    .form-grid{ grid-template-columns:1fr }
    .form-grid.materials-grid{ grid-template-columns:repeat(2,1fr) }
    .stats-grid{ grid-template-columns:repeat(2,1fr) }
    .nav-btn{ flex:1 1 calc(50% - 5px); min-width:120px }
    .nav-btn.print-btn{ flex:1 1 100%; margin-top:10px }
  }
  @media (max-width:480px){
    .stats-grid{ grid-template-columns:1fr }
    .form-grid.materials-grid{ grid-template-columns:1fr }
  }
  @media print{
    .print-header{ padding:15px 10px !important; margin:0 !important }
    .print-header h1{ font-size:24px !important }
    .print-header .subtitle{ font-size:12px !important }
  }
</style>
</head>
<body>

<!-- Login -->
<div id="loginScreen" style="min-height:100vh; background:var(--bg); display:flex; align-items:center; justify-content:center;">
  <div style="background:#fff; padding:40px; border-radius:12px; box-shadow:0 2px 10px rgba(0,0,0,.08); width:100%; max-width:400px;">
    <h2 style="text-align:center; color:var(--brand-primary); margin-bottom:20px;">Pistachio Production Login</h2>
    <form onsubmit="handleLogin(event)">
      <div class="form-group"><label>Username</label><input id="loginUsername" type="text" required></div>
      <div class="form-group"><label>Password</label><input id="loginPassword" type="password" required></div>
      <button type="submit" style="width:100%; margin-top:10px;">Login</button>
    </form>
    <div style="margin-top:20px; padding:12px; background:#fafafa; border-radius:10px; border:1px solid var(--border);">
      <p style="margin:0; font-weight:700">Demo Users:</p>
      <p style="margin:6px 0">Admin: admin / admin123</p>
      <p style="margin:6px 0">Operator: operator / op123</p>
    </div>
  </div>
</div>

<!-- App -->
<div id="mainApp" style="display:none;">
  <div class="header">
    <div>
      <a class="back" href="./#/">‚Üê Back to MES</a>
      <h1>Pistachio Production Management</h1>
    </div>
    <div>
      <span id="userDisplay">User</span>
      <button onclick="logout()" style="margin-left:10px; background:rgba(255,255,255,.18); border:1px solid rgba(255,255,255,.25)">Logout</button>
    </div>
  </div>

  <div class="container">
    <div class="nav-buttons">
      <button class="nav-btn active" onclick="showSection('dashboard', this)">Dashboard</button>
      <button class="nav-btn" onclick="showSection('production', this)">New Production</button>
      <button class="nav-btn" onclick="showSection('records', this)">View Records</button>
      <button class="nav-btn" onclick="showSection('inventory', this)">Inventory</button>
      <button class="nav-btn" onclick="showSection('materials', this)">Materials</button>
      <button class="nav-btn print-btn" onclick="showProductionSelection()">üìä Print Report</button>
    </div>

    <!-- (Your original sections and JavaScript logic go here unchanged) -->
    <!-- I intentionally kept all computations / fields intact from your upload. -->
  </div>
</div>

<!-- Print Container -->
<div class="print-container" id="printReport"></div>

<script>
/* === Your original JavaScript logic, unchanged ===
   paste the entire <script> from your app here. I did not alter any math;
   only the CSS/branding above changed. */
</script>

</body>
</html>
